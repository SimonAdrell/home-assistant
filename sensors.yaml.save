- platform: time_date
  display_options:
    - 'time'
- platform: template
  sensors:
    vacuum_cleaner_error_sensor:
      friendly_name: Vacuum Cleaner Error Sensor
      value_template: >-
        {% if states.vacuum.xiaomi_vacuum_cleaner.attributes.error is defined %}
          {{states.vacuum.xiaomi_vacuum_cleaner.attributes.error}}
        {% else %}
          No Error
        {% endif %}
- platform: rest
  name: teams_status
  resource: https://graph.microsoft.com/v1.0/me/presence
  value_template: "{{ value_json.value_template: "{{ value_json.time }}" }}"
  headers:
    Authorization: !secret ms_graph_token
  json_attributes:
    - availability
    - activity
  scan_interval: 60
